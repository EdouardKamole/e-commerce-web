"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[23461],{705533:(e,l,i)=>{var t;i.r(l),i.d(l,{default:()=>s});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DebugSignalsFeedback_pin",selections:[{alias:null,args:null,concreteType:"SignalDecisionDict",kind:"LinkedField",name:"debAds",plural:!0,selections:t=[{alias:null,args:null,kind:"ScalarField",name:"backgroundColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"iconUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"signalId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"signalMessage",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SignalDecisionDict",kind:"LinkedField",name:"debContentQuality",plural:!0,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SignalDecisionDict",kind:"LinkedField",name:"debInclusiveProduct",plural:!0,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SignalDecisionDict",kind:"LinkedField",name:"debShopping",plural:!0,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SignalDecisionDict",kind:"LinkedField",name:"debTrustAndSafety",plural:!0,selections:t,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"Pin",abstractKey:null};n.hash="06530ceab8fc1bb7b5d868c8ffeb2afd";let s=n},343902:(e,l,i)=>{i.d(l,{N:()=>r,Z:()=>s});var t=i(883119),n=i(785893);function s({children:e,fullWidth:l}){return(0,n.jsx)(t.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto",width:l?"100%":void 0}},"data-test-id":"pointer-events-wrapper",children:e})}function r({children:e,enabled:l}){return l?(0,n.jsx)(s,{children:e}):e}},259866:(e,l,i)=>{i.d(l,{Z:()=>t});function t(e){return function e(l,i){let t;if(null==l||"object"!=typeof l&&"function"!=typeof l)return l;let n=i.find(e=>e.value===l);if(n)return n.result;let s=Object.prototype.toString.call(l);switch(s){case"[object Array]":t=Array(l.length);break;case"[object Set]":t=new Set;break;case"[object Object]":case"[object Arguments]":t={};break;case"[object Map]":t=new Map;break;default:return l}let r=[...i,{value:l,result:t}];switch(s){case"[object Array]":l.forEach((l,i)=>{t[i]=e(l,r)});break;case"[object Set]":l.forEach(l=>{t.add(e(l,r))});break;case"[object Object]":case"[object Arguments]":Object.entries(l).forEach(([l,i])=>{t[l]=e(i,r)});break;case"[object Map]":l.forEach((l,i)=>{t.set(i,e(l,r))})}return t}(e,[])}},361747:(e,l,i)=>{i.d(l,{Z:()=>r});var t=i(883119),n=i(140017),s=i(785893);function r({height:e,isDenseView:l,rounding:i,width:r,color:a}){let o=(0,n.ZP)();return(0,s.jsx)(t.xu,{alignItems:"center",color:a||"default","data-test-id":"unavailable-pin",display:"flex",height:e,justifyContent:"center",overflow:"hidden",position:"relative",rounding:i,width:r,children:(0,s.jsxs)(t.kC,{alignItems:"center",direction:"column",children:[(0,s.jsx)(t.xu,{paddingY:l?2:4,children:(0,s.jsx)(t.JO,{accessibilityLabel:o._('Pin not available', 'story-pin.Closeup.UnavailableIdeaPin.icon.accessibilityLabel', 'Accessibility label on icon'),color:"default",icon:"alert",size:20})}),(0,s.jsx)(t.xv,{weight:"bold",children:o._('Unavailable', 'story-pin.Closeup.UnavailableIdeaPin.Unavailable', 'Text on an unavailable idea Pin that has been deleted')}),!l&&(0,s.jsx)(t.xu,{paddingY:1,children:(0,s.jsx)(t.xv,{children:o._('Removed by the creator', 'story-pin.Closeup.UnavailableIdeaPin.Removed', 'Text on an unavailable idea Pin explaining it has been removed by its creator')})})]})})}},325362:(e,l,i)=>{i.d(l,{Z:()=>t});function t(e){return e.replace(/[_.-](\w|$)/g,(e,l)=>l.toUpperCase())}},446653:(e,l,i)=>{i.d(l,{r:()=>j,K:()=>y});var t=i(667294),n=i(342513),s=i(340523),r=i(757640),a=i(149722),o=i(998577),c=i(573810),d=i(325362);let u=e=>{let l={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&("object"!=typeof e[i]||null===e[i]||Array.isArray(e[i])?l[(0,d.Z)(i)]=e[i]:l[(0,d.Z)(i)]=u(e[i]));return l},h=(e,l)=>{let i=[];for(let t in e)t!==l&&i.push({id:t,...u(e[t])});let t=i.sort(({user:{businessName:e}},{user:{businessName:l}})=>e.localeCompare(l)),n=new Map;for(let e of t)n.set(e.id,e);return n},_={profiles:new Map,headerVisible:!1,orbacVisibility:!1,activeProfile:void 0,disableProfileChanger:!1},g=(e,l)=>{switch(l.type){case"LOAD_PROFILES":return{...e,profiles:l.payload};case"SET_ACTIVE_PROFILE":return{...e,activeProfile:l.payload};case"TOGGLE_HEADER_VISIBILITY":return{...e,headerVisible:l.payload};case"TOGGLE_ORBAC_VISIBILITY":return{...e,orbacVisibility:l.payload};case"TOGGLE_DISABLE_PROFILE_CHANGER":return{...e,disableProfileChanger:l.payload};default:return e}},p=({dispatch:e,isEnabled:l,state:i})=>{let{orbacVisibility:n,disableProfileChanger:s,headerVisible:r}=i,a=(0,t.useCallback)(i=>{l&&e({type:"SET_ACTIVE_PROFILE",payload:i})},[l,e]),o=(0,t.useCallback)(i=>{l&&e({type:"TOGGLE_ORBAC_VISIBILITY",payload:i??!n})},[l,e,n]),c=(0,t.useCallback)(i=>{l&&e({type:"TOGGLE_DISABLE_PROFILE_CHANGER",payload:i??!s})},[l,e,s]),d=(0,t.useCallback)(i=>{l&&e({type:"TOGGLE_HEADER_VISIBILITY",payload:i??!r})},[l,e,r]);return{changeProfile:a,toggleORBACVisibility:o,toggleDisableProfileChanger:c,toggleHeaderVisibility:d}},f=e=>{let[l,i]=(0,t.useReducer)(g,_),n=p({dispatch:i,isEnabled:e,state:l}),{activeProfile:s,orbacVisibility:r}=l;(0,t.useEffect)(()=>{let e=(0,c.qn)("orbacActiveProfile",!1);e&&i({type:"SET_ACTIVE_PROFILE",payload:e})},[]),(0,t.useEffect)(()=>{let e=(0,c.qn)("orbacVisibilty",!1);e&&i({type:"TOGGLE_ORBAC_VISIBILITY",payload:e})},[]),(0,t.useEffect)(()=>{(0,c.Nh)("orbacVisibility",r)},[r]),(0,t.useEffect)(()=>{(0,c.Nh)("orbacActiveProfile",s)},[s]);let a=(0,t.useCallback)((e,l)=>{i({type:"LOAD_PROFILES",payload:h(e,l)})},[i]);return{state:l,actions:n,receiveProfiles:a}};var x=i(785893);let{Provider:b,useMaybeHook:y}=(0,n.Z)("RoleBasedAccessControlContext"),j=({children:e})=>{let l;let{checkExperiment:i}=(0,s.F)(),n=(0,a.Z)(),c=!!(n.isAuth&&n.isPartner&&i("web_m10n_business_access_orbac_www").anyEnabled),{state:d,actions:u,receiveProfiles:h}=f(c),{activeProfile:_,headerVisible:g,profiles:p=[]}=d,y=p?Array.from(p.values()):[],j=(0,o.Z)(y),m=!!n.isAuth&&y.length>0&&j,v=n.isAuth?n.id:"",A=n.isAuth?n.username:"",{changeProfile:I,toggleORBACVisibility:P,toggleDisableProfileChanger:w,toggleHeaderVisibility:E}=u;(0,t.useEffect)(()=>{if(c){if("string"==typeof j){I(j);return}_||I(v)}},[j,v,c,I,_]),(0,t.useEffect)(()=>{c&&(m&&!g&&E(!0),!m&&g&&E(!1))},[E,m,c,g,p]);let{data:S}=(0,r.Z)(c?{name:"ApiResource",options:{url:"/vx/business_access/profiles/",disable_auth_failure_redirect:!0}}:null),k=S?.profiles;n&&n.isAuth&&d.activeProfile===n.id?l={id:n.id,permissions:["OWNER"],user:{username:A,businessName:n.fullName,imgUrl:n.imageSmallUrl}}:_&&d.profiles&&(l=d.profiles.get(_)),(0,t.useEffect)(()=>{k&&h(k,v)},[h,k,v]);let C=d.profiles?Array.from(d.profiles.values()):[];return(0,x.jsx)(b,{value:{profiles:C,headerVisible:d.headerVisible,activeProfile:l,changeProfile:I,toggleORBACVisibility:P,toggleDisableProfileChanger:w,toggleHeaderVisibility:E},children:e})}},785059:(e,l,i)=>{i.d(l,{Z:()=>r});var t=i(340523),n=i(446653),s=i(998577);let r=()=>{let{checkExperiment:e}=(0,t.F)(),l=(0,n.K)(),{activeProfile:i}=l||{},r=e("web_m10n_business_access_orbac_www").anyEnabled,a=(0,s.Z)(l?.profiles||[]),{anyEnabled:o}=e("useorbacroutematcher_in_useorbacactingas");return r&&(!o||a)&&i&&(i.viewerMeetsMfaRequirement||(i.permissions||[]).includes("OWNER"))?i:Object.freeze({})}},998577:(e,l,i)=>{i.d(l,{Z:()=>o});var t=i(616550),n=i(96157),s=i(340523),r=i(149722),a=i(19447);let o=e=>{let l=(0,t.TH)(),i=(0,r.Z)(),o=(0,a.S6)(),{anyEnabled:c}=(0,s.F)().checkExperiment("web_m10n_business_access_orbac_www"),d=(0,t.$B)("/:username"),u=d?.params?.username,h=(0,t.$B)("/pin/:id"),_=!!h?.params?.id&&o(h.params.id)?.pinner?.id;if((0,n.ej)(l))return!1;if((0,n.RU)(l))return!0;if((0,n.mY)(l))return c;let g=e.concat(i.isAuth?{user:{username:i.username},id:i.id}:{}).find(e=>{let{user:l={},id:i}=e||{},{username:t}=l;return(!!t&&!!u||!!_&&!!i)&&(t===u||_===i)});return!!g&&g.id}},199677:(e,l,i)=>{i.d(l,{D3:()=>c,DX:()=>a,KY:()=>d,Ms:()=>t,N1:()=>u,_P:()=>r,lJ:()=>s,nl:()=>n,q6:()=>o});let t=(e,l)=>{let i=e&&e.isAuth?e.username:"";return e&&l&&l.user&&l.user.username&&(i=l.user.username),i},n=(e,l)=>!!(l&&l.user&&e&&e.isAuth&&l.id!==e.id?l.user.eligibleForStlTool:e&&e.isAuth&&e.eligibleForStlTool),s=(e,l)=>e&&e.isAuth&&l&&l.id&&l.id!==e.id?l.id:"",r=(e,l,i)=>i&&i.user&&l&&l.isAuth&&i.id!==l.id?i.user.merchantId:e.advertiser?.merchant_id,a=(e,l,i)=>i&&i.user&&e.isAuth&&i.id!==e.id?i.user.scheduledPinCount||0:e.isAuth&&l&&l.scheduled_pin_count||0,o=(e,l,i)=>{let t=e&&e.isAuth&&i&&i.id&&i.id!==e.id&&i.id===l;return!!t},c=(e,l,i)=>{let t=o(e,l,i)||e&&e.isAuth&&l===e.id;return!!t},d=(e,l,i)=>{let t=l&&l.owner&&l.owner.id||"";return c(e,t,i)};function u(e,l,i){let t=l?l.id:"";return c(e,t,i)}},156032:(e,l,i)=>{i.d(l,{Z:()=>P});var t,n=i(667294);i(167912);var s=i(616550),r=i(883119),a=i(510989),o=i(207012),c=i(343902),d=i(608516),u=i(477458),h=i(149722),_=i(785893);let g=({signal:e,anchor:l,setShowFlyout:i,setStore:t})=>{let{hovered:n,onMouseEnter:s,onMouseLeave:a}=(0,u.Z)(),o=e=>{i(e=>!e),t(e)};return(0,_.jsx)(r.iP,{onMouseEnter:s,onMouseLeave:a,onTap:()=>o(e),rounding:"pill",children:(0,_.jsxs)(r.xu,{ref:l,alignItems:"center",color:n?"dark":"transparentDarkGray",display:"flex",padding:3,rounding:"pill",children:[(0,_.jsx)(r.xu,{alignItems:"center",color:"default",display:"flex",height:24,justifyContent:"center",marginEnd:1,minWidth:24,rounding:"circle",children:(0,_.jsx)(r.xu,{height:20,overflow:"hidden",rounding:"circle",width:20,children:(0,_.jsx)(r.Ee,{alt:"",color:e.backgroundColor??"",naturalHeight:1,naturalWidth:1,src:e.iconUrl??""})})}),(0,_.jsx)(r.xv,{color:"inverse",size:"200",weight:"bold",children:e.signalMessage})]})})};var p=i(107366),f=i(140017),x=i(13848),b=i(454514);function y(e){let l=(0,f.ZP)(),{onHide:i}=e,t=(0,_.jsx)(r.xv,{children:l._('Thank you for helping improve signal detection on Pinterest!', 'pinRep.actionBar.signalDetector.toast', 'Toast text displayed when a user submits a signal for review')});return(0,_.jsx)(b.ZP,{onHide:i,text:t})}let j=function({anchor:e,onDismiss:l,pinId:i,signal:t}){let n=(0,f.ZP)(),s=(0,h.Z)(),{showOneToast:a}=(0,x.F9)();if(!s.isEmployee)return null;let{backgroundColor:o,iconUrl:c,signalId:d,signalMessage:u}=t;return(0,_.jsx)(r.mh,{children:(0,_.jsx)(r.J2,{anchor:e,idealDirection:"right",onDismiss:l,positionRelativeToAnchor:!1,size:"lg",children:(0,_.jsxs)(r.xu,{padding:4,width:"100%",children:[(0,_.jsx)(r.kC,{alignItems:"center",justifyContent:"start",children:(0,_.jsx)(r.X6,{size:"400",children:n._('Signal detected:', 'pinRep.actionBar.signalDetector.header', 'Header for signal detector flyout')})}),(0,_.jsx)(r.xu,{paddingY:3,children:(0,_.jsxs)(r.kC,{alignItems:"center",gap:2,justifyContent:"center",children:[(0,_.jsx)(r.xu,{height:40,overflow:"hidden",rounding:"circle",width:40,children:c?(0,_.jsx)(r.Ee,{alt:n._('Signal display', 'pinRep.actionBar.signalDetector.signalAsset', 'Asset to represent the signal detected'),color:"white",naturalHeight:1,naturalWidth:1,src:c}):(0,_.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:o??""}},height:40,width:40})}),(0,_.jsx)(r.xv,{size:"200",children:u})]})}),(0,_.jsx)(r.xu,{marginBottom:3,children:(0,_.jsx)(r.xv,{size:"200",children:n._('If you think this detection is inaccurate, please send this Pin for review. It will help improve Pinterest.', 'pinRep.actionBar.signalDetector.instructions', 'Instructions to the user for how to handle inaccurate detection')})}),(0,_.jsxs)(r.kC,{alignItems:"center",gap:2,justifyContent:"start",children:[(0,_.jsx)(r.zx,{color:"red",fullWidth:!0,onClick:()=>{(0,p.Z)({url:`/v3/pins/${i}/signal_request_review/`,method:"POST",data:{signal_id:d,user:s.id}}),l(),a(({hideToast:e})=>(0,_.jsx)(y,{onHide:e}))},size:"md",text:n._('Send for review', 'pinRep.actionBar.signalDetector.button.review', 'Button label for users to send the pin for review')}),(0,_.jsx)(r.zx,{color:"gray",fullWidth:!0,onClick:l,size:"md",text:n._('Cancel', 'pinRep.actionBar.signalDetector.button.cancel', 'Button label for users to cancel')})]})]})})})};function m({signals:e,pinId:l}){let[i,t]=(0,n.useState)(!1),s=(0,n.useRef)(null),[o,u]=(0,n.useState)(e[0]);return(0,_.jsxs)(n.Fragment,{children:[(0,_.jsx)(a.Z,{name:"SafeSuspense_DebugSignal_FeedbackButton",children:(0,_.jsx)(d.Z,{children:(0,_.jsx)(r.xu,{"data-test-id":"debug-signals-feedback-button",children:(0,_.jsx)(c.Z,{children:(0,_.jsx)(r.kC,{alignItems:"stretch",justifyContent:"start",children:e.map(e=>(0,_.jsx)(r.xu,{marginEnd:2,children:(0,_.jsx)(g,{anchor:s,setShowFlyout:t,setStore:u,signal:e})},e.signalId))})})})})}),i&&(0,_.jsx)(j,{anchor:s.current,onDismiss:()=>t(!1),pinId:l,signal:o})]})}let v=function({anchor:e,onDismiss:l,pinId:i,signals:t}){let s=(0,f.ZP)(),[a,o]=(0,n.useState)(0),c=(0,h.Z)(),{showOneToast:d}=(0,x.F9)();if(!c.isEmployee)return null;let u=t.map(({signalMessage:e})=>({href:"#",text:e??""})),{backgroundColor:g,iconUrl:b,signalId:j,signalMessage:m}=t[a],v=({activeTabIndex:e})=>{o(e)};return(0,_.jsx)(r.mh,{children:(0,_.jsx)(r.J2,{anchor:e,idealDirection:"right",onDismiss:l,positionRelativeToAnchor:!1,size:"lg",children:(0,_.jsxs)(r.xu,{padding:4,width:"100%",children:[t.length>1&&(0,_.jsx)(r.xu,{marginBottom:4,overflow:"scrollX",padding:1,children:(0,_.jsx)(r.mQ,{activeTabIndex:a,onChange:({event:e,activeTabIndex:l,dangerouslyDisableOnNavigation:i})=>{e.preventDefault(),i(),v({activeTabIndex:l})},tabs:u})}),(0,_.jsx)(r.kC,{alignItems:"center",justifyContent:"start",children:(0,_.jsx)(r.X6,{size:"400",children:s._('Signal detected:', 'pinRep.actionBar.signalDetector.header', 'Header for signal detector flyout')})}),(0,_.jsx)(r.xu,{paddingY:3,children:(0,_.jsxs)(r.kC,{alignItems:"center",gap:{row:2,column:0},justifyContent:"center",children:[(0,_.jsx)(r.xu,{height:40,overflow:"hidden",rounding:"circle",width:40,children:b?(0,_.jsx)(r.Ee,{alt:s._('Signal display', 'pinRep.actionBar.signalDetector.signalAsset', 'Asset to represent the signal detected'),color:"white",naturalHeight:1,naturalWidth:1,src:b}):(0,_.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:g??""}},height:40,width:40})}),(0,_.jsx)(r.xv,{size:"200",children:m})]})}),(0,_.jsx)(r.xu,{marginBottom:3,children:(0,_.jsx)(r.xv,{size:"200",children:s._('If you think this detection is inaccurate, please send this Pin for review. It will help improve Pinterest.', 'pinRep.actionBar.signalDetector.instructions', 'Instructions to the user for how to handle inaccurate detection')})}),(0,_.jsxs)(r.kC,{alignItems:"center",gap:{row:2,column:0},justifyContent:"start",children:[(0,_.jsx)(r.zx,{color:"red",fullWidth:!0,onClick:()=>{(0,p.Z)({url:`/v3/pins/${i}/signal_request_review/`,method:"POST",data:{signal_id:j,user:c.id}}),l(),d(({hideToast:e})=>(0,_.jsx)(y,{onHide:e}))},size:"md",text:s._('Send for review', 'pinRep.actionBar.signalDetector.button.review', 'Button label for users to send the pin for review')}),(0,_.jsx)(r.zx,{color:"gray",fullWidth:!0,onClick:l,size:"md",text:s._('Cancel', 'pinRep.actionBar.signalDetector.button.cancel', 'Button label for users to cancel')})]})]})})})},A=void 0!==t?t:t=i(705533);function I({signals:e,pinId:l}){let{backgroundColor:i,iconUrl:t,signalMessage:s}=e[0],[o,h]=(0,n.useState)(!1),g=(0,n.useRef)();return(0,_.jsxs)(n.Fragment,{children:[(0,_.jsx)(a.Z,{name:"SafeSuspense_DebugSignal_FeedbackButton",children:(0,_.jsx)(d.Z,{children:(0,_.jsx)(r.xu,{"data-test-id":"debug-signals-feedback-button",children:(0,_.jsx)(c.Z,{children:(0,_.jsx)(u.q,{children:({hovered:e,onMouseEnter:l,onMouseLeave:n})=>(0,_.jsx)(r.iP,{onMouseEnter:l,onMouseLeave:n,onTap:()=>h(e=>!e),rounding:"pill",children:(0,_.jsxs)(r.xu,{ref:g,alignItems:"center",color:e?"dark":"transparentDarkGray",display:"flex",padding:3,rounding:"pill",children:[(0,_.jsx)(r.xu,{alignItems:"center",color:"default",display:"flex",height:24,justifyContent:"center",marginEnd:1,rounding:"circle",width:24,children:(0,_.jsx)(r.xu,{height:20,overflow:"hidden",rounding:"circle",width:20,children:(0,_.jsx)(r.Ee,{alt:"",color:i??"",naturalHeight:1,naturalWidth:1,src:t??""})})}),(0,_.jsx)(r.xv,{color:"inverse",size:"200",weight:"bold",children:s})]})})})})})})}),o&&g&&g.current&&(0,_.jsx)(v,{anchor:g.current,onDismiss:()=>h(!1),pinId:l,signals:e})]})}function P({pinKey:e}){let l=(0,o.Z)(A,e),i=(0,h.Z)(),{search:t}=(0,s.TH)(),r=(0,n.useMemo)(()=>new URLSearchParams(t),[t]);if(!i.isEmployee)return null;let{entityId:a,debAds:c,debContentQuality:d,debInclusiveProduct:u,debShopping:g,debTrustAndSafety:p}=l;if(c)return(0,_.jsx)(I,{pinId:a,signals:c});if(d)return(0,_.jsx)(I,{pinId:a,signals:d});if(u){if("skin_tone"===r.get("type")){let e=u.filter(e=>"visual_signals_hair_pattern_v1"!==e.signalId);return(0,_.jsx)(m,{pinId:a,signals:e})}{let e=u.filter(e=>"visual_body_analyses_v2_0"!==e.signalId);return(0,_.jsx)(m,{pinId:a,signals:e})}}return g?(0,_.jsx)(I,{pinId:a,signals:g}):p?(0,_.jsx)(I,{pinId:a,signals:p}):null}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/23461-d04a5489e4b8cac0.mjs.map